<html>
<head>
    <style> 
    p{ 
        text-align: center;
    }
       h1{
    border:none;
    height:auto;
    background-color: yellow;
    margin: 0%;
    padding: 0%;
}
#head{
    background-color: red;
    margin: none;
    text-align: center;
}
.header{
    margin: none;
}
div{
    border:none;
    height:auto;
    display:inline;
    margin: 0%;
    padding:0%;
   
}
.playBoard{
    background-color: aliceblue;
}
.hd{
    grid-area: hd;
    background-color:red;
}
#boardWrapper{
    border:none;
    margin: none;
    column-gap:0;
    display:grid;
    height:100%;
    width:100%;
    grid-template-columns: repeat(10, 1fr);
    grid-auto-rows:minmax(auto, auto);
    grid-template-areas:
        "hd hd hd hd hd hd hd hd hd hd"
        "board board board board board board board board score score"
        "board board board board board board board board score score"
        "board board board board board board board board score score"
        "board board board board board board board board graveyard graveyard"
        "board board board board board board board board graveyard graveyard"
        "board board board board board board board board graveyard graveyard"
        "board board board board board board board board graveyard graveyard"
        "hand hand hand hand hand hand hand hand hand hand"
        "hand hand hand hand hand hand hand hand hand hand";

    
}
.card{
    padding: 10px;
	border: solid 1px #808080;
	background-color: white;
	display: inline-block;
	border-radius: 10px;
	font-size: 14pt;
	text-align: center;
	color:black;
	margin: 3px;
}
.board{
    border:none;
    grid-area:board;
    padding:0%;
    margin: 0%;
    background-color: dodgerblue;
    display:grid;
    grid-template-columns: repeat(10, 1fr);
    grid-auto-rows:minmax(auto, auto);
    grid-template-areas:
        "yb yb yb yb yb yb yb yb yb yb"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b1 b1 b1 b1 b1 b1 b1 b1 b1 b1"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2"
        "b2 b2 b2 b2 b2 b2 b2 b2 b2 b2";
    
}
.yourBoard{
    grid-area: yb;
}
.score{
    grid-area: score;
    background-color: forestgreen;
}

.hand{
    grid-area:hand;
}

.graveyard{
    grid-area: graveyard;
    background-color: dimgrey;
}
#score{
    font-size:20pt;
}

#escore{
    font-size:20pt;
}
#turn
{
    text-align: center;
    font-size: 20pt;
    color:peru
}
.hand2{
    grid-area:hand2;
}

#board1{
    grid-area:b1;
    background-color:tomato
}

#board2{
    grid-area:b2;
}

.login
{
    border:none;
    text-align: center;
    
}
    </style>
</head>
<script src="/socket.io/socket.io.js"></script>

<div class = "header">
    <h1 id="head"> Welcome to Out of Control!</h1>
</div>
<body>
    <div id = "boardWrapper">
        <div class="hd">
            <div class="login">
                <p> <a href="/index.html"> Homepage </a> </p>
            </div>
        
            <div class="login">
                <p> <a href="/rules.html" target="_blank"> Click here to read the rules!</a>  </p>
            </div>
        </div>

        <div class="board">
            <h1 class="yourBoard"> The Board </h1>
            <div  id="board1">board1</div>
            <div  id="board2">board2</div>
        </div>
    
        <div class="score">
            <h1> Your Score </h1>
            <p id="score"> 0 </p>
            <h1> Enemy Score </h1>
            <p id="escore"> 0 </p>
            <h1> Turn </h1>
            <p id="turn"> Player 1's Turn </p>
        </div>
    
        <div class="graveyard">
            <h1> Your Graveyard </h1>
            <div id="graveyard">graveyard</div>
        </div>
    
        <div class="hand">
            <h1>Your Hand</h1>
            <a class="draw" href="javascript:void(0)" class="btn" onclick="draw(deck, hand1)">Draw</a>
            <div id="hand1">Your Hand</div>
        </div>
    </div>
   
</body>

<script>


//These are the two types of cards
var types = ["stable", "unstable"];
//Names of the cards - shows on the front 
var names = ["Rift", "Reactor", "Force Field" , "Exotic Matter", "Deflector", "Anomoly", 
"Wormhole", "Rewind", "Future Shift", "Dark Energy", "Singularity", 
"Antimatter", "Time Stop", "Nova"];

//different ranks for the cards - goes 1 through 10
var ranks = [1, 2, 3,3, 4, 4, 5, 5, 6, 6, 7, 8, 9, 10]




//Variables for keeping track of what is and is not allowed at any given time
var dischargeVal = 0;
var grave = false;
var exotic = false;
var anomoly = false;
var rewind = false;
var darkEnergy = false;
var reactor = false;



//deck for player one, hand for player 1
var deck1 = new Array();
var hand1 = new Array();

//deck for player two, hand for player 2
var deck2 = new Array();
var hand2 = new Array();

//this board is for the current player 
var board = new Array();


//this is for the other player
var board1 = new Array();

//This is the graveyard
var graveyard = new Array();

var turn = 0; //mod2 remainder 1 means player 1s turn, remainder 0 means player 2's turn
//starts at 0 because we call renderall right away

//this function updates the turn displayed on the screen for the user - it does so 
function updateTurn()
{
    let v = document.getElementById("turn"); //gets our page

    if(turn%2 == 1) //if it's not divisible by 2, it's player 1s turn
    {
        

        v.innerHTML = "Player 1's Turn";

    }

    else //otherwise, it is player two's turn
        v.innerHTML = "Player 2's Turn";

}

//this is to activate card abilities. This is called when stable cards are played to the board, or when unstable cards are discarded.
function ability(name, rank, type, location)
{
    if(name == "Rift") //rift
    {
        //rift just draws a card to the hand
        draw(deck, hand1);
    }
    
    if(name == "Reactor") //reactor
    {
        reactor = true; //set reactor to true, so we know that we are allowed to mimic. This is checked in the mimic function. 
        alert("Choose a card in play to mimic its ability"); //alert the user that they are allowed to mimic.

    }
    
    if(name == "Exotic Matter") //exotic matter
    {
        exotic = true; //set exotic to true, which is checked when a card is played after exotics ability activates.
        alert("You may play another card worth 3 or less"); //alert the player
		
    }
    
    if(name == "Anomoly") //anomoly
    {
        anomoly = true; //set anomoly to true, which is checked when a card is chosen to be destroyed after wormhole's ability activates.
        alert("Select a stable card to destroy"); //alert the player
    }
    
    if(name == "Wormhole") //wormhole
    {
        grave = true; //set grave to true, so we can recover a card from the graveyard
        alert("Select a card from the graveyard to return to your hand") //alert the player
    }
    
    if(name == "Rewind") //rewind
    {
        rewind = true; //sets rewind to true, which is checked in the rewind function to see if we can choose a card to move 
        alert("Pick a card to be placed onto the bottom of its deck") //alert the player
    }
    if(name == "Dark Energy") //dark energy
    {
        darkEnergy = true; //sets dark energy to true, which is checked in the copy function
        alert("Pick a stable card on the board to copy to your board") //alert the player
    }
    
    if(name == "Singularity") //singularity
    {
        alert("Board Wiped"); //alert the player that the board is being wiped
        for(let i = 0; i < board.length; i++) { //iterate through the first board and discard everything
            discard(board[i].Name, board[i].Rank, board[i].Type, board[i].Location);
		}
	    
        for(let i = 0; i < board1.length; i++) //iterate through the second board and discard everything
        {
            discard(board1[i].Name, board1[i].Rank, board1[i].Type, board1[i].Location);
        }
    }
}

function createDeck() //this is the function we use to build our decks
{
    //Each player gets 26 cards in their deck - two of each card
    let deck = new Array();
    //create the stable cards
    for(let i = 0; i < 2; i++)
    {
        for(let j = 0; j < types.length;j++) //second loop to get through them all - our total is going to be 26

        {
            if(j == 0) //stable loop
            {
                for(let k = 0; k < 4; k++) //first four ranks are stable
                {
                    let card = {Type: types[j], Name: names[k], Rank: ranks[k], Location: 0}; //create our card objects 
                    deck.push(card); //push the card on top of the deck
                }
                
            }
            else //unstable loop for the rest
            {
                for(let k = 4; k < names.length; k++)
                {
                    let card = {Type: types[j], Name: names[k], Rank: ranks[k], Location: 0}; //create our card objects 
                    deck.push(card);//push the card on top of the deck
                }
            }
        }
    }

    return deck; //returns deck. In our initialization, this is what our deck objects are set to. 
}

//This function is to shuffle the deck after it is created, to make sure that we aren't always drawing the same card. It takes in a deck object, created through 
//createDeck()
function shuffle(passedDeck)
{
    for(let i = 0; i < 1000; i++)//give it a 1000 tries
    {
        //generate some seeds to randomize
        let location1 = Math.floor(Math.random() * passedDeck.length);
        let location2 = Math.floor(Math.random() * passedDeck.length);

        //just a temp deck to swap the position
        let temp = passedDeck[location1];

        passedDeck[location1] = passedDeck[location2] //swap positions
        passedDeck[location2] = temp; //insert the temp card to the random spot in our deck
    }
}
//this function is called when the buttons are clicked on the cards in a users hand. Its parameters in the fields for the cards, value, name, rank, type, and location. 
function selectOption(value, name, rank, type,location)
{
    if(value == "0") //the player selected play
    {
        playCard(name, rank, type); //call the playCard function (this will activate its abilit)
        socket.volatile.emit("play", name + "," + rank + "," + type, (response) =>{ //this is to send the message to the server that we have chosen to play a card
            console.log("response is " + response.status);
        });
    }
    if(value == "1") //player selected discard
    {
        discard(name, rank, type, location); //call the discard function
    }
    if(value == "2") //player selected discharge 
    {
        discharge(name, rank, type, location); //called the discharge function
    }
}
//this is our function to draw a card. It takes as parameters an array for the deck, an array for the hand
function draw(passedDeck, passedHand)
{
    passedHand[passedHand.length] = passedDeck.pop(); //pop a card off of the passedDeck, and add it to the passedHand at the end of the array.
    
    renderAll(); //we call renderAll to update our board
}

//the getscore function is meant to calculate the score of the cards on the board for the user
function getScore()
{
    //initialized score - starts at 0, for obvious reasons
    var score = 0; 

    for(var i = 0; i < board.length; i++)
    {
        //walk through the board(I originally thought it was the hand where the score came from)
        score = score + board[i].Rank; //the score is cumulative, so add the score up based on the ranks of the cards on the board
        //update score
    }
    
    if(score >= 21) //you play to 21 to win 
    {
        alert("YOU WIN!!"); //let the player know that they won with an alert
    }
    //append the score to the HTML
    document.getElementById('score').innerHTML = score.toString(); //score is an int, so we have to convert it to a string to append it properly
}
//getscore2() is meant to calculate the score for the enemy's board
function getScore2()
{
    //initialized score - starts at 0, for obvious reasons
    var score = 0;

    for(var i = 0; i < board1.length; i++)
    {
        //walk through the board(I originally thought it was the hand where the score came from)
        score = score + board1[i].Rank; //the score is cumulative, so add the score up based on the ranks of the cards on the board
        //update score
    }
    
    if(score >= 21) //the game is played to 21
    {
        alert("YOU LOSE!!"); //if the other player gets to 21, you lose!
    }
    //append the score to the HTML
    document.getElementById('escore').innerHTML = score.toString(); //score is an int, so we have to convert it to a string to append it properly
}

//findCardIndex returns the first known index a card occurs in a deck. Its parameters are an array for passedDeck,
//then the name, rank, and type of the card being search for.
//we need the index specifically for functions like playCard()
function findCardIndex(passedDeck,name, rank, type)
{
    for(var i = 0; i < passedDeck.length; i++) //iterate through the deck that was passed in
    {
        //if we find a card that matches what we're looking for, return the index.
        //Otherwise the loop will just go again until we've reached the end of the deck
        if(passedDeck[i].Rank == rank && passedDeck[i].Name == name && passedDeck[i].Type == type)
        {
            return i;
        }
    }
}

//findCard finds a card if it's in the first deck passed in
//using the name, rank, and type parameters,
//and will place that card in the second deck passed in
function findCard(passedDeck, name, rank, type, newDeck)
{
    for(var i = 0; i < passedDeck.length; i++) //iterate through the first deck given
    {
        //if we find a card that matches the rank, name, and type passed to the function
        if(passedDeck[i].Rank == rank && passedDeck[i].Name == name && passedDeck[i].Type == type)
        {
            newDeck[newDeck.length] = passedDeck[i]; //add that card to the end of the newdeck
            passedDeck.splice(i, 1); //remove that card from the old deck
            return; //return from the function
        }
    }
}

//playCard is used to play cards from the hand, and activate their abilities
//if the card is stable
function playCard(name, rank, type, location) //you will only play cards from the hand
{
    if(exotic == true) //check our exotic variable
    {
        if(rank <= 3) //exotic allows you to play a card of equal or lesser value,
        {             //so the card being played must be worth 3 or less
            exotic = false; //reset the exotic variable
            playCard(name, rank, type, location); //play the card with the variable reset.
        }                                        
        else //if they choose a card with a value that is too high 
        {
            alert("Choose a card worth 3 or less"); //alert the player
            return; //exit the function
        }
    }

    let x = findCardIndex(hand1, name, rank, type); //get the index
    hand1[x].Location = 1; //change location to board
    board[board.length] = hand1[x];//add the card to the board
    hand1.splice(x,1); //remove the card from the hand
    if(type == "stable") //stable cards call their abilities when they are played
    {
        ability(name, rank, type, location); //call the ability function for the card
    }
    renderAll(); //we have moved a card, so render the board again
}


function playEnemyCard(name, rank, type, location)
{
    //deck = createDeck();
    console.log("playing card");
    let x = findCardIndex(testDeck, name, rank, type);
    testDeck[x].Location = 3; //change location to enemy board
    board1[board1.length] = testDeck[x];//add the card to the board
    testDeck.splice(x,1); //remove the card from the hand
    

    renderAll();
}

//discard is used to send cards to the graveyard. To discard a card,
//we will need to know it's name, rank, type, and location.
function discard(name, rank, type,location)
{
    if(location == 0) //this card is in the hand
    {
        let x = findCardIndex(hand1, name, rank, type); //get the index
        hand1[x].location = 2; //change location to the graveyard
        graveyard[graveyard.length] = hand1[x]; //add card to the graveyard
        hand1.splice(x,1); //remove the card from the hand
        if(type == "unstable") //unstable cards activate their abilities when discarded
        {
            ability(name, rank, type, location); //call the ability function
        }

        renderAll(); //we moved a card, so re-render the board.
    }
    if(location == 1) //this card is on the board
    {
        let x = findCardIndex(board, name, rank, type); //get the index
        board[x].location = 2; //change location to the graveyard
        graveyard[graveyard.length] = board[x]; //add the card to the graveyard
        board.splice(x,1); //remove the card from the board
        renderAll(); //we moved a card, so re-render the board.
    }

}

//the discharge function gets called when users choose the discharge option on cards.
//the parameters are the name, rank, type, and location of the card you are discharging
function discharge(name, rank, type, location)
{
    //alert to tell the player what to do
    alert("Choose a card of lower or equal value on the board to discard");
    dischargeVal = rank; //set dischargeVal, which is used to make sure players don't
                         //then remove a card with a value that is too high
    discard(name, rank, type, location); //call discard to move the card to the graveyard
}

//returnGrave is used to return a card from the grave to the hand.
//its parameters are the name, rank, type, and location of the card
//being returned
function returnGrave(name, rank, type, location)
{
    if(grave == true) //we check this to make sure that the correct card has been played
    {                 //to allow the returning of a card to the hand

        let x = findCardIndex(graveyard, name, rank, type); //get our index
        graveyard[x].Location = 0; //change location to hand
        hand1[hand1.length] = graveyard[x];//add the card to the hand
        graveyard.splice(x,1); //remove the card from the graveyard
        if(type == "stable") //stable cards call their abilities when they are played
        {
            ability(name, rank, type, location);
        }
        grave = false; //reset the grave variable so players can't return other cards
    }

    else
    {
        alert("Not allowed at this time"); //let the player know they can't return
                                           //cards from the grave at this time
    }

    renderAll(); //we moved a card, so we re-render the board
    
}

//dischargeBoard is for discharging a card from the board.
//its parameters are the name, rank, type, and location
//of the card you are attempting to discharge
function dischargeBoard(name, rank, type, location)
{
    //we can only discharge cards after a card from the hand has been discharged
    //and the card we remove from the board must be of lower value
    if(rank <= dischargeVal)
    {                       
        discard(name, rank, type, location); //discard the card
        dischargeVal = 0; //reset the discharge value
    }
    else
    {
        alert("Choose a different card to discharge - this card is worth too much"); //let the player know they need to choose something else
    }
}

//renderHand renders the users hand
function renderHand()
{
    document.getElementById('hand1').innerHTML = ''; //set the innerHTML for the tag with the id 'hand1' to nothing
    
    for(var i = 0; i < hand1.length; i++) //iterate through the hand1 array
    {
        var card = document.createElement("div"); //create a div for the card
        var rank = document.createElement("div"); //create a div for the rank
        var type = document.createElement("div"); //create a div for the type

        var select = document.createElement("select"); //create our drop down
        //this is the function call
        var s = "selectOption(this.value," + "'" + hand1[i].Name + "'" + "," + hand1[i].Rank + "," + "'" + hand1[i].Type + "'" + ","  + hand1[i].Location + ")";

        //when the button is changed, call the function specified above
        select.setAttribute("onchange", s);
        //add the select box to the cards
        document.body.appendChild(select);

         //sets rank based on the rank of the card
		rank.innerHTML = hand1[i].Name + " (" + hand1[i].Rank + ")" + "( " + hand1[i].Type + ")";

        //appends the rank type and select button to the card element
		card.appendChild(rank);
		card.appendChild(type);
        card.appendChild(select);

        card.className = "card";
        //used to set the id
        var s = rank.toString + type.toString;

        var blank = document.createElement("option"); //create the option element
        blank.setAttribute("value", "Select a move"); //set the value attribute
        blank.setAttribute("selected", "selected"); //set the selected attribute 
        select.appendChild(blank); //append our newly created option to the select element
        blank.appendChild(document.createTextNode("Select an Option")); //add the text to that option 
        for(var k = 0; k < 3; k++) //we are going to create three more buttons
        {
            var option = document.createElement("option"); //create another option element
            option.setAttribute("value", k); //set its value to the loop we are on
            select.appendChild(option); //append the option to the select element
            if(k == 0) //first loop
                option.appendChild(document.createTextNode("Play")); //create and append the play text
            if(k == 1) //second loop
                option.appendChild(document.createTextNode("Discard")); //create and append the discard text
            if(k == 2) //third loop
                option.appendChild(document.createTextNode("Discharge")); //create and append the discharge text
        }

        document.getElementById('hand1').appendChild(card); //append the card to the hand element

    }
}


//renderHand2 renders the enemies hand
function renderHand2()
{
    document.getElementById('hand2').innerHTML = ''; //set the innerHTML for the tag with the id 'hand1' to nothing
    
    for(var i = 0; i < hand2.length; i++) //iterate through the hand2 array
    {
        var card = document.createElement("div"); //create a div for the card
        var rank = document.createElement("div"); //create a div for the rank
        var type = document.createElement("div"); //create a div for the type

        var select = document.createElement("select"); //create our drop down
        //this is the function call
        var s = "selectOption(this.value," + "'" + hand2[i].Name + "'" + "," + hand2[i].Rank + "," + "'" + hand2[i].Type + "'" + ","  + hand2[i].Location + ")";

        //when the button is changed, call the function specified above
        select.setAttribute("onchange", s);
        //add the select box to the cards
        document.body.appendChild(select);

         //sets rank based on the rank of the card
		rank.innerHTML = hand2[i].Name + " (" + hand2[i].Rank + ")" + "( " + hand2[i].Type + ")";

        //appends the rank type and select button to the card element
		card.appendChild(rank);
		card.appendChild(type);
        card.appendChild(select);

        card.className = "card";
        //used to set the id
        var s = rank.toString + type.toString;

        var blank = document.createElement("option"); //create the option element
        blank.setAttribute("value", "Select a move"); //set the value attribute
        blank.setAttribute("selected", "selected"); //set the selected attribute 
        select.appendChild(blank); //append our newly created option to the select element
        blank.appendChild(document.createTextNode("Select an Option")); //add the text to that option 
        for(var k = 0; k < 3; k++) //we are going to create three more buttons
        {
            var option = document.createElement("option"); //create another option element
            option.setAttribute("value", k); //set its value to the loop we are on
            select.appendChild(option); //append the option to the select element
            if(k == 0) //first loop
                option.appendChild(document.createTextNode("Play")); //create and append the play text
            if(k == 1) //second loop
                option.appendChild(document.createTextNode("Discard")); //create and append the discard text
            if(k == 2) //third loop
                option.appendChild(document.createTextNode("Discharge")); //create and append the discharge text
        }

        document.getElementById('hand2').appendChild(card); //append the card to the hand element

    }
}

//mimic is called when a card ability is being mimiced
//it taks as parameters the name, rank, type, and location
//of the card being mimiced
function mimic(name, rank, type, location)
{
    if(reactor == true) //mimic can only be called if reactor is played
    {
        reactor = false; //reset the reactor condition
        ability(name, rank, type, location); //call the ability
    }
    else
    {
        alert("Not allowed at this time"); //tell the player they're not allowed to do that
        return; //exit the function
    }
}

//destroy is called when the destroy option is chosen on the board
//its parameters are the name, rank, type, and location of the card being chosen
function destroy(name, rank, type, location)
{
    if(anomoly == true) //anomoly must have been called to destroy a card
    {
        if(type == "stable") //we can only destroy stable cards
        {
            anomoly = false; //reset the anomoly condition
            discard(name, rank, type, location); //discard the card
        }
        else
        {
            //tell the player to pick a stable card
            alert("Choose a card that is stable to destroy"); 
        }
            
            
        
    }
    else //the anomoly conidtion is not met
    {
        alert("Not allowed at this time"); //alert the player
        return; //exit the  function
    }
}

//boardOptions is called from the board when players
//select the buttons from cards on the board
//it takes as parameters the value, name, rank, type,
//and location of the  card chosen
function boardOptions(value, name, rank, type, location)
{
    if(value == 0) //this is for mimic
    {
        mimic(name, rank, type, location); //mimic the card
    }
    if(value == 1) //this is for discharge
    {
        dischargeBoard(name, rank, type, location); //discharge the card
    }
    if(value == 2) //this is for destroy
    {
        destroy(name, rank, type, location); //destroy the card
    }
}

//copy is called to copy the ability of a card
//it takes as parameters the name, rank, type, 
//and location of the card chosen to copy
function copy(name, rank, type, location)
{
    //we can only copy cards when dark energy is played
    if(darkEnergy == true)
    {
        //we can only copy stable cards
        if(type == "stable")
        {
            darkEnergy = false; //reset the dark energy conditional
        
            let tempDeck = createDeck();//create a temporary deck
            let x = findCardIndex(tempDeck, name, rank, type); //find the card in the temp deck
            board[board.length] = tempDeck[x]; //put that card on the players board 
            socket.volatile.emit("play", name + "," + rank + "," + type, (response) =>{
            console.log("response is " + response.status); //let the server know we 'played' a card because we copied it
        });

            renderAll(); //render everything again since we moved a card
        }
        else
        {
            alert("Choose a stable card to copy"); //alert the player they need a stable card
            return; //exit the function 
        }
        
    }
    else
    {
        alert("Not allowed at this time"); //alert the player they can't copy right now
        return; //exit the function
    }
}
//eboard options is called when the buttons on the cards
//on the enemy board are clicked
//it takes as parameters the value, name, rank, type,
//and location of the chosen card
function eboardOptions(value, name, rank, type, location)
{
    if(value == 0)//this is for copy
    {
        copy(name, rank, type, location); //call the copy function

    }
    if(value == 1) //this is for discharge
    {
        dischargeBoard(name, rank, type, location); //call the discharge function
    }
    if(value == 2) //this is for destroy
    {
        destroy(name, rank, type, location); //call the destroy function
    }
}


//renderBoard renders the board for the user
//it uses the board variable to build their board
function renderBoard()
{
    
    document.getElementById('board2').innerHTML = ''; //get the element that we will be changing
    for(var i = 0; i < board.length; i++) //iterate through the board
    {
        var card = document.createElement("div"); //create a div for the card
        var rank = document.createElement("div"); //create a div for the document
		var type = document.createElement("div"); //create a div for the type
        //create the button to discharge
        var select = document.createElement("select"); //create a select element

        //create a string that will work for our function call
        var s = "boardOptions(this.value," + "'" + board[i].Name + "'" + "," + board[i].Rank + "," + "'" + board[i].Type + "'" + ","  + board[i].Location + ")";

        //when the button is changed, call the function specified above
        select.setAttribute("onchange", s);
        //add the select box to the cards
        document.body.appendChild(select);

         //sets rank based on the rank of the card
		rank.innerHTML = board[i].Name + " (" + board[i].Rank + ")" + "( " + board[i].Type + ")";

        //appends the rank type and select button to the card element
		card.appendChild(rank);
		card.appendChild(type);
        card.appendChild(select);

        card.className = "card";
        //used to set the id
        var s = rank.toString + type.toString;

        var blank = document.createElement("option"); //create an option element
        blank.setAttribute("value", "Select a move"); //set the value attribute on that element 
        blank.setAttribute("selected", "selected"); //set the selected attribute on that element
        select.appendChild(blank); //append the option element to the select element we made earlier
        blank.appendChild(document.createTextNode("Select an Option")); //append the text to select an option
        for(var k = 0; k < 3; k++) //we are creating three more options 
        {
            var option = document.createElement("option"); //create an option element 
            option.setAttribute("value", k); //set the value based on the loop
            select.appendChild(option); //append the new option to the select element
            if(k == 0) //we are in loop 1
                option.appendChild(document.createTextNode("Mimic")); //add mimic text to the option element
            if(k == 1) //we are in loop 2
                option.appendChild(document.createTextNode("Discharge")); //add discharge text to the option element
            if(k == 2) //we are in loop 3
                option.appendChild(document.createTextNode("Destroy")); //add the destroy text to the option element
        }
        document.getElementById('board2').appendChild(card); //append our card to the 'board2' element

    }
}

//renderBoard renders the board for the enemy
//it uses the board1 variable to build their board
function renderBoard1()
{
    
    document.getElementById('board1').innerHTML = ''; //get the element that we will be changing
    for(var i = 0; i < board1.length; i++) //iterate through the board1
    {
        var card = document.createElement("div"); //create a div for the card
        var rank = document.createElement("div"); //create a div for the document
		var type = document.createElement("div"); //create a div for the type
        //create the button to discharge
        var select = document.createElement("select"); //create a select element

        //create a string that will work for our function call
        var s = "boardOptions(this.value," + "'" + board1[i].Name + "'" + "," + board1[i].Rank + "," + "'" + board1[i].Type + "'" + ","  + board1[i].Location + ")";

        //when the button is changed, call the function specified above
        select.setAttribute("onchange", s);
        //add the select box to the cards
        document.body.appendChild(select);

         //sets rank based on the rank of the card
		rank.innerHTML = board1[i].Name + " (" + board1[i].Rank + ")" + "( " + board1[i].Type + ")";

        //appends the rank type and select button to the card element
		card.appendChild(rank);
		card.appendChild(type);
        card.appendChild(select);

        card.className = "card";
        //used to set the id
        var s = rank.toString + type.toString;

        var blank = document.createElement("option"); //create an option element
        blank.setAttribute("value", "Select a move"); //set the value attribute on that element 
        blank.setAttribute("selected", "selected"); //set the selected attribute on that element
        select.appendChild(blank); //append the option element to the select element we made earlier
        blank.appendChild(document.createTextNode("Select an Option")); //append the text to select an option
        for(var k = 0; k < 3; k++) //we are creating three more options 
        {
            var option = document.createElement("option"); //create an option element 
            option.setAttribute("value", k); //set the value based on the loop
            select.appendChild(option); //append the new option to the select element
            if(k == 0) //we are in loop 1
                option.appendChild(document.createTextNode("Mimic")); //add mimic text to the option element
            if(k == 1) //we are in loop 2
                option.appendChild(document.createTextNode("Discharge")); //add discharge text to the option element
            if(k == 2) //we are in loop 3
                option.appendChild(document.createTextNode("Destroy")); //add the destroy text to the option element
        }
        document.getElementById('board1').appendChild(card); //append our card to the 'board1' element

    }
}

//renders the grave for the user
function renderGrave()
{
    document.getElementById('graveyard').innerHTML = ''; //get our html element
    for(var i = 0; i < graveyard.length; i++) //iterate through the graveyard array 
    {
        var card = document.createElement("div"); //create a card div
		var rank = document.createElement("div"); //create a rank div
		var type = document.createElement("div"); //create a type div 


        var select = document.createElement("select"); //create a select element 

        //create a string to use for our function call
        var s = "returnGrave(" + "'" + graveyard[i].Name + "'" + "," + graveyard[i].Rank + "," + "'" + graveyard[i].Type + "'" + "," + graveyard[i].Location + ")";

        
        select.setAttribute("onchange", s); //set the onchange attribute for our select element

        card.className = "card"; //set the card class name
		rank.className = "rank"; //set the rank class name
		type.className = "type" + graveyard[i].Type; //set the type class name

        

        //sets rank based on the rank of the card
		rank.innerHTML = graveyard[i].Name + " (" + graveyard[i].Rank + ")" + "( " + graveyard[i].Type + ")";

          //appends the rank type and select button to the card element
		card.appendChild(rank);
		card.appendChild(type);
        card.appendChild(select);
        //card.appendChild(select);
        //used to set the id

        var blank = document.createElement("option"); //create the option element 
        blank.setAttribute("value", "Select a move"); //set the value attribute
        blank.setAttribute("selected", "selected"); //set the selected attribute
        select.appendChild(blank); //append the option element to the select element 

        var option = document.createElement("option"); //create another option element
        blank.appendChild(document.createTextNode("Select an option")); //append the select an option textnode
        option.appendChild(document.createTextNode("Return from Grave")); //append the return from the grave text node

        select.appendChild(option); //append our option element to the select element

        document.getElementById('graveyard').appendChild(card); //append the card to the element with the id graveyard in the html
    }
}

//renderAll is meant to be a catchall function to call the other various render  functions
function renderAll()
{
    renderHand();
    renderBoard();
    renderBoard1();
    renderGrave();

    getScore();
    getScore2();

    updateTurn();
    turn++;//we increment the turn when we render the page

}
//load is called when the window is loaded, it's basically the init function
function load()
{
    //deck for user 1
    deck = createDeck();
    //deck for user 2
    deck2 = createDeck();
    //shuffle deck1
    shuffle(deck);

    for(var i = 0; i < 7; i++)
    {
        draw(deck, hand1); //draw the cards to the hand
    }
    
    renderAll(); //render everything
}
//executes load function when the browser window loads 
window.onload = load;


/// Below this line is the code used for communicating with the server

const testDeck = createDeck(); //used to make sure we always have a deck to draw cards from 

var socket = io(); //creates the socket that we will use to communicate with the server 

//when our socket object receives a message(msg) from the server with the lable 'play2',
//we want to play a card for the enemy, based on the information in the msg,
//which will be the rank, type, etc of the card they played
socket.on('play2', function(msg) { 

    playEnemy(msg);
});

//playEnemy plays the enemy card to the correct board
function playEnemy(msg)
{

    let deck2 = createDeck(); //create a deck - this makes sure we can make whatever card we need


    //the msg sent by the server is the name, rank, and type, seperated by commas
    let indexFirst = msg.indexOf(","); //find the first comma

    let indexSecond = msg.indexOf(",", indexFirst + 1); //find the second comma

    let name = msg.slice(0, indexFirst); //get the name of the card 

    let rank = msg.slice(indexFirst + 1, indexSecond); //get the rank of the card

    let type = msg.slice(indexSecond + 1, msg.length); //get the type of the card 

    //because of the nature of sockets, we have to check to make sure that deck2
    //is not undefined so we don't draw a card from it when it  doesn't exist
    if(deck2 != undefined)
    {
        let x = -1; //used to find our card
        for(var i = 0; i < deck2.length; i++) //iterate through our deck2 object 
        {
            if(deck2[i].Name == name) //if we find the right card
            {
                x = i; //set x to i
                break; //exit our loop
            }
            else
                x = 100000000; //set x to a number it can never be so we know we failed
            
        }
    
        deck2[x].Location = 3; //change location to enemy board 
        board1[board1.length] = deck2[x];//add the card to the board
        deck2.splice(x,1); //remove the card from the hand
    
        renderAll(); //call render all to update the board
    }

    

}
</script>
</html>
